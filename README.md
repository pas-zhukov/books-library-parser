# Парсер онлайн-библиотеки [Tululu](https://tululu.org)

---
Скрипт позволяет скачать определённое количество книг, их обложек, а также данных об этих книгах. 
Есть возможность скачивать внутри категории или подряд.

Используя скрипт для скачивания по жанрам, Вы также получаете json-файл с описанием всех скачанных книг.

## Установка зависимостей
Первым делом, скачайте код:
``` 
git clone https://github.com/pas-zhukov/books-library-parser.git
```
Для работы скрипта понадобятся библиотеки, перечисленные в `reqirements.txt`.
Устанавливаем их командой:
```
pip install -r requirements.txt
```

## Переменные окружения

Для работы скрипта рядом с ним необходимо положить файл `.env` со следующими полями:

- `IMAGES_PATH` - путь к папке с изображениями. Туда будут скачиваться обложки книг.
- `BOOKS_PATH` - путь к папке с книги. Туда будут скачиваться txt файлы с книгами.
- `CONNECTION_TIMEOUT` (секунды) - в течение какого времени будут предприниматься попытки возобновить интернет-соединение при его потере. Если не указать, по умолчанию будет 120 секунд.

_Пример заполнения файла можно посмотреть в `.env.example`._

## Запуск

### Сквозной парсинг (всех книг подряд)

Запуск скрипта осуществляется следующей командой:
```shell
python main.py [аргументы]
```

Доступны следующие аргументы:

- `--start_id <начальный id>` или `-s <начальный id> `- ID книги, с которой начнётся скачивание. По умолчанию = 1.

- `--end_id <конечный id>` или `-e <конечный id>` - ID, на котором скачивание остановится. Должен быть больше, чем start_id. По умолчанию = 10.

- `--list` - отобразить ли по окончании загрузки список скачанных книг в терминале.

Например, такая команда скачает книги с ID=[20,30) и выведет в консоль их список:
```shell
python main.py -s 20 -e 30 --list
```

### Парсинг по жанрам

Запуск скрипта по жанрам осуществляется следующей командой:
```shell
python parse_tululu_category.py [аргументы]
```

Доступны следующие аргументы:

- `--start_page <номер стр.>` или `-s <номер стр.> `- номер страницы в разделе жанра книг, с которой начнётся скачивание. По умолчанию = 1.

- `--end_page <номер стр.>` или `-e <номер стр.>` - номер страницы, на котором скачивание остановится. Должен быть больше, чем start_page. По умолчанию скачает до 1000, либо до самой последней страницы в разделе жанра.
- `--dest_folder <имя папки>` или `--d <имя папки>` - папка, в которую будут сохраняться книги, их обложки, json-файл с данными о книгах. Структуру папок внутри этой папки определяют переменные окружения (см. выше). Если этот аргумент у вас `folder`, а в переменной окружения для папки с обложками `img`, то обложки сохранятся по такому пути: `/folder/img/`.
- `--category_id <ID категории>` или `--cat <ID категории>` - ID жанра книг на сайте Tululu, для которого будут загружаться книги. По умолчанию - 55 (научная фантастика).
- `--skip_imgs` - не скачивать обложки.
- `--skip_txt` - не скачивать тексты книг.

Например, такая команда скачает книги с жанром научной фантастики (Id=55), со страницы 5 по страницу 10, сохранит всё скачанное в папку `for_granny`
```shell
python parse_tululu_category.py -s 5 -e 10 -d for_granny
```

_Где брать ID книг? Откройте [сайт библиотеки](https://tululu.org/), откройте несколько разных книг и посмотрите на URL каждой из них, это поможет._

_То же самое касается ID жанров._

## Цели проекта
Код написан в учебных целях.